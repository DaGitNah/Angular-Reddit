<div class="card" ng-if="controller.errorMessage">
	<span class="error" ng-bind="controller.errorMessage"></span>
</div>

<div class="card" ng-if="!controller.errorMessage">
	<div class="sort">
		<span class="sort-text">Sort:</span>
		<select ng-model="controller.time" ng-change="app.setLocation('r/'+controller.subreddit+'/'+controller.sort+'/'+controller.time+'/'+controller.last)">
			<option value="day">past 24 hours</option>
			<option value="week">past week</option>
			<option value="month">past month</option>
			<option value="year">past year</option>
			<option value="all">all time</option>
		</select>
	</div>
</div>

<div class="posts">
	<div class="card link" ng-repeat="post in controller.posts track by post.data.id">
		<div class="rank" ng-bind="$index+1"></div>

		<div class="vote">
			<div class="score" ng-bind="post.data.score"></div>
		</div>


		<a class="thumbnail" ng-click="app.setLocation(post.data.media.oembed.thumbnail_url, true)" 
			ng-if="post.data.thumbnail && post.data.thumbnail != 'self' && post.data.thumbnail != 'default' && post.data.thumbnail != 'nsfw'">
			<img src="{{post.data.thumbnail}}" alt="{{post.data.title}}">
		</a>

		<div class="entry">
			<a ng-if="post.data.is_self" class="title" ng-click="app.setLocation('post/'+post.data.subreddit+'/'+post.data.id,false)">
				<span class="linkflairlabel" ng-if="post.data.link_flair_text" ng-bind="post.data.link_flair_text"></span> 
				<span class="nsfwtag" ng-if="post.data.over_18">NSFW</span> 
				<span ng-bind-html="post.data.title"></span>
			</a>
			<a ng-if="!post.data.is_self" class="title" ng-click="app.setLocation(post.data.url, true)">
				<span class="linkflairlabel" ng-if="post.data.link_flair_text" ng-bind="post.data.link_flair_text"></span> 
				<span class="nsfwtag" ng-if="post.data.over_18">NSFW</span> 
				<span ng-bind-html="post.data.title"></span>
			</a>

			<span class="domain"><a href="" ng-bind="'('+post.data.domain+')'"></a></span>
			
			<p class="tagline">submitted by <a ng-click="app.setLocation('http://www.reddit.com/user/' + post.data.author, true)" class="author" ng-bind="post.data.author"></a>
				to <a ng-click="app.setLocation('r/'+post.data.subreddit+'/top',false)" class="subreddit" ng-bind="post.data.subreddit"></a> 
				{{post.data.created_utc | utcdatetolocal | timeago}} 
			</p>

			

			<ul class="flat-list buttons">
				<li class="first">
					<a ng-click="app.setLocation('post/'+post.data.subreddit+'/'+post.data.id,false)" class="comments" ng-bind="post.data.num_comments + ' comments'"></a>
				</li>
				<li>
					<clickview link="post.data" ng-if="post.data.is_self"></clickview>
				</li>
			</ul>
		</div>

		<div class="clear"></div>
	</div>
	<div class="pagination">
		<button ng-click="app.setLocation('r/'+controller.subreddit+'/'+controller.sort+'/'+controller.time+'/'+controller.first+'/before')" class="btn btn-prev">&lt; prev</button>
		<button ng-click="app.setLocation('r/'+controller.subreddit+'/'+controller.sort+'/'+controller.time+'/'+controller.last+'/after')" class="btn btn-next">more &gt;</button>
	</div>	
</div>